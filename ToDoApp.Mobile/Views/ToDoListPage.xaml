<?xml version="1.0" encoding="utf-8"?>

<pages:BaseContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
                       xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                       xmlns:viewmodels="clr-namespace:ToDoApp.Mobile.ViewModels"
                       xmlns:pages="clr-namespace:ToDoApp.Mobile.Views"
                       xmlns:controls="clr-namespace:ToDoApp.Mobile.Controls"
                       xmlns:models="clr-namespace:ToDoApp.Mobile.Models"
                       x:Class="ToDoApp.Mobile.Views.ToDoListPage"
                       x:DataType="viewmodels:ToDoListViewModel">
    <pages:BaseContentPage.Content>
        <Grid>
            <Grid RowDefinitions="1*,9*">
                <Grid
                    BackgroundColor="{DynamicResource PrimaryFpTheme}"
                    Grid.Row="0">
                    <Label
                        Grid.Column="0"
                        Text="Todo List"
                        FontSize="26"
                        FontAttributes="Bold"
                        Padding="10,5"
                        VerticalTextAlignment="Center"
                        TextColor="WhiteSmoke" />
                    <ImageButton
                        Margin="10,5"
                        BackgroundColor="WhiteSmoke"
                        VerticalOptions="Center"
                        HorizontalOptions="End"
                        CornerRadius="20"
                        Command="{Binding AddToDoCommand}" />
                </Grid>
                <RefreshView
                    Grid.Row="1"
                    IsRefreshing="{Binding IsRefreshing}"
                    Command="{Binding RefreshToDoListCommand}"
                    RefreshColor="{DynamicResource PrimaryFpTheme}">
                    <CollectionView
                        x:Name="CollectionViewToDoList"
                        SelectionMode="None"
                        ItemsSource="{Binding ToDoList}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="models:ToDoItem">
                                <ContentView
                                    BackgroundColor="WhiteSmoke"
                                    Padding="9">
                                    <Grid
                                        Padding="9"
                                        ColumnDefinitions="9*,1*"
                                        BackgroundColor="White">
                                        <VerticalStackLayout
                                            Grid.Column="0">
                                            <Label Text="{Binding Title}" FontSize="16" />
                                            <Label Text="{Binding DisplayCreatedAtDate}" FontSize="12"
                                                   FontAttributes="Italic" />
                                            <Label Text="{Binding DisplayPriority}" FontSize="12" FontAttributes="Bold" />
                                        </VerticalStackLayout>
                                        <Switch
                                            Grid.Column="1"
                                            IsToggled="True"
                                            OnColor="{DynamicResource PrimaryFpTheme}"
                                            ThumbColor="Gray" />

                                    </Grid>
                                </ContentView>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </RefreshView>
            </Grid>
            <controls:TDLoaderView
                IsLoadingEnabled="{Binding IsBusy}"
                IsVisible="{Binding IsBusy}"
                HorizontalOptions="Fill"
                VerticalOptions="Fill" />
        </Grid>
    </pages:BaseContentPage.Content>
</pages:BaseContentPage>