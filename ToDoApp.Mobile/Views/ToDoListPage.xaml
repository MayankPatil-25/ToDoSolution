<?xml version="1.0" encoding="utf-8"?>

<pages:BaseContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
                       xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                       xmlns:viewmodels="clr-namespace:ToDoApp.Mobile.ViewModels"
                       xmlns:pages="clr-namespace:ToDoApp.Mobile.Views"
                       xmlns:controls="clr-namespace:ToDoApp.Mobile.Controls"
                       xmlns:models="clr-namespace:ToDoApp.Mobile.Models"
                       xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
                       x:Class="ToDoApp.Mobile.Views.ToDoListPage"
                       x:DataType="viewmodels:ToDoListViewModel">
    <pages:BaseContentPage.Content>
        <Grid>
            <Grid RowDefinitions="1*,9*">
                <Grid
                    BackgroundColor="{DynamicResource PrimaryFpTheme}"
                    Grid.Row="0">
                    <Label
                        Grid.Column="0"
                        Text="Todo List"
                        FontSize="26"
                        FontAttributes="Bold"
                        Padding="10,5"
                        VerticalTextAlignment="Center"
                        TextColor="WhiteSmoke" />
                    <Button
                        Margin="10,5"
                        BackgroundColor="WhiteSmoke"
                        VerticalOptions="Center"
                        HorizontalOptions="End"
                        HeightRequest="30"
                        WidthRequest="30"
                        CornerRadius="25"
                        Command="{Binding AddToDoCommand}">
                        <Button.ImageSource>
                            <FontImageSource Glyph="+"
                                             FontFamily="MaterialIcons"
                                             Size="34"
                                             Color="Black" />
                        </Button.ImageSource>
                    </Button>
                </Grid>
                <RefreshView
                    Grid.Row="1"
                    IsRefreshing="{Binding IsRefreshing}"
                    Command="{Binding RefreshToDoListCommand}"
                    RefreshColor="{DynamicResource PrimaryFpTheme}">
                    <CollectionView
                        x:Name="CollectionViewToDoList"
                        SelectionMode="None"
                        ItemsSource="{Binding ToDoList}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="models:ToDoItem">
                                <ContentView
                                    BackgroundColor="WhiteSmoke"
                                    Padding="9">
                                    <Border
  
                                            StrokeShape="RoundRectangle 5">
                                        <Grid
                                            IsClippedToBounds="True"
                                            ColumnDefinitions="25,*,Auto"
                                            BackgroundColor="White">
                                            <Grid.Behaviors>
                                                <toolkit:TouchBehavior
                                                    LongPressCommand="{Binding Source={x:Reference CollectionViewToDoList}, Path=BindingContext.ToDoItemLongPressCommand}"
                                                    LongPressCommandParameter="{Binding}" />
                                            </Grid.Behaviors>
                                            <BoxView
                                                Grid.Column="0"
                                                BackgroundColor="{Binding PriorityIndicator}" />
                                            <VerticalStackLayout
                                                Grid.Column="1"
                                                Spacing="5"
                                                Padding="9">
                                                <Label Text="{Binding Title}"
                                                       FontSize="16" />
                                                <Label Text="{Binding Description}"
                                                       FontSize="13" />
                                                <Grid>
                                                    <Label Text="{Binding DisplayPriority}"
                                                           FontSize="11"
                                                           FontAttributes="Bold"
                                                           HorizontalTextAlignment="Start"
                                                           HorizontalOptions="Start" />
                                                    <Label Text="{Binding DisplayCreatedAtDate}"
                                                           FontSize="11"
                                                           FontAttributes="Italic"
                                                           HorizontalOptions="End"
                                                           HorizontalTextAlignment="End"/>
                                                </Grid>
                                            </VerticalStackLayout>
                                            <Switch
                                                Margin="0,0,9,0"
                                                Grid.Column="2"
                                                IsToggled="True"
                                                OnColor="{DynamicResource PrimaryFpTheme}"
                                                ThumbColor="Gray" />

                                        </Grid>
                                    </Border>
                                </ContentView>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </RefreshView>
            </Grid>
            <controls:TDLoaderView
                IsLoadingEnabled="{Binding IsBusy}"
                IsVisible="{Binding IsBusy}"
                HorizontalOptions="Fill"
                VerticalOptions="Fill" />
        </Grid>
    </pages:BaseContentPage.Content>
</pages:BaseContentPage>